<!DOCTYPE html>
<html>
<head>

  <title>Studio</title>
  <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>-->
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
<link rel="icon" type="image/png" href="images/favicon.png">

 <style>
      *{
        cursor: url('images/cursor2.png'), auto;
      }
	  
#toggle-controls {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 9999;
 background-color: #4CAF50;
 border: none;
 padding: 10px 20px;
 font-size: 16px;
  border-radius: 20px; 
    transform-style: preserve-3d;
    cursor: pointer;
	 box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.3);
 }
 
#toggle-controls:hover {
  background-color: #3e8e41; 
  transform: translateY(-2px) translateZ(0); 
   box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.5);
}


    </style>
	
	
	<script>
let controlsEnabled = false;
let obj;
 
 function initScene()
 {
	obj = document.getElementById('interactable-obj');
	
	//const button = document.getElementById("toggle-controls");


 }
 
 
 function clicked()
 {
	//button.addEventListener("click", function() {
  //console.log("patithike!");
  
	  if ( !controlsEnabled )
	  {
		controlsEnabled = true; 
		
		document.getElementById('player').setAttribute('wasd-controls', {enabled:'false'});
		document.getElementById('player').setAttribute('look-controls', {enabled:'false'});
	  }
	  else
	  {
		controlsEnabled = false; 
		document.getElementById('player').setAttribute('wasd-controls', {enabled:'true'});
		document.getElementById('player').setAttribute('look-controls', {enabled:'true'});
	  }
	  
		
	
 }
 
 

<!-- elegxos patimatos koumpiou -->


</script> 

	
</head>



<body>



<body oncontextmenu="return false;" onload="initScene();">


<button id="toggle-controls" onclick="clicked();">Toggle Controls</button>


 
 
<script>


    AFRAME.registerComponent('drag-rotate-component',{
      schema : { speed : {default:2.4}},
      init : function(){
        this.ifMouseDown = false;
        this.x_cord = 0;
        this.y_cord = 0;
        document.addEventListener('mousedown',this.OnDocumentMouseDown.bind(this));
        document.addEventListener('mouseup',this.OnDocumentMouseUp.bind(this));
        document.addEventListener('mousemove',this.OnDocumentMouseMove.bind(this));
      },
      OnDocumentMouseDown : function(event){
        this.ifMouseDown = true;
        this.x_cord = event.clientX;
        this.y_cord = event.clientY;
      },
      OnDocumentMouseUp : function(){
        this.ifMouseDown = false;
      },
      OnDocumentMouseMove : function(event)
      {
        if(this.ifMouseDown && controlsEnabled)
        {
          var temp_x = event.clientX-this.x_cord;
          var temp_y = event.clientY-this.y_cord;
          if(Math.abs(temp_y)<Math.abs(temp_x))
          {
            this.el.object3D.rotateY(temp_x*this.data.speed/1000);
          }
          
          this.x_cord = event.clientX;
          this.y_cord = event.clientY;
        }
      }
    });
	
	AFRAME.registerComponent('cameramove',{
      
      init : function(){
	  
		 document.addEventListener('wheel',this.OnWheel.bind(this));
        
      },
      OnWheel : function(event){
        
		let xyz = this.el.getAttribute('position');
		if (event.deltaY <0 )
		{
			xyz.z += .1; 
		}
		else
		{
			xyz.z -= 0.1;
		}
			
		//this.el.setAttribute('zvalue', z);
		this.el.setAttribute('position', xyz);
		console.log('z = ' + z);
      }
	  
	 
	  }
	  
	  );
	  	  
	  
	  AFRAME.registerComponent('zoom',{
	  

      
      init : function(){
	  
	    this.minScale = 0.7;
		this.maxScale = 1.8;
		
		 document.addEventListener('wheel',this.OnWheel.bind(this));
        
      },
      OnWheel : function(event){
	  
        console.log(event.deltaX + ", " + event.deltaY);
		let xyz = this.el.getAttribute('scale');
		
		if (event.deltaY <0 && xyz.x < this.maxScale && xyz.y < this.maxScale && xyz.z < this.maxScale)
		{
			xyz.x += 0.05;
			xyz.y += 0.05;
			xyz.z += 0.05;

		}
		else if(event.deltaY > 0 && xyz.x > this.minScale && xyz.y > this.minScale && xyz.z > this.minScale)
		{
			xyz.x -= 0.05;
			xyz.y -= 0.05;
			xyz.z -= 0.05;
		}
			
		this.el.setAttribute('scale', xyz);
		

		//this.el.setAttribute('position', '0 1 ' + z);
		//console.log('z = ' + z);
      }
	  
	 
	  }
	  
	  );
	
	
  </script>
  
  <a-scene id="my-scene">
  
<a-assets>
  <audio id="music" src="sounds/generalsound.mp3" preload="auto" ></audio>
  <img id="gradient" src="images/gradient.png">
   <img id="sky" src="https://cdn.aframe.io/a-painter/images/sky.jpg"> <!-- ChatGpt=Make a nicer sky-->
</a-assets>

<a-entity sound="src:#music" volume="0.5"></a-entity>


<a-sphere material="src:#moon; color: white; roughness: 1; metalness: 0.1"
          position="-40 35 -30"
          radius="2"
          animation="property: rotation; from: 0 0 0; to: 0 360 0; loop: true;  dur: 35000; easing:linear;">
    <a-img id="moon" src="images/moon.jpg"></a-img>
</a-sphere>


   <a-sky src="#sky" scale="1 1 1" position="0 20 0"></a-sky>

  <a-plane material="src:#gradient" position="0 0 0" rotation="-90 0 0" width="120" height="30" color="lightgrey" metalness="0.4"></a-plane>  
    <a-asset-item id="Object" src="StudioModel.glb"> </a-asset-item> 
	<a-entity id="interactable-obj"  gltf-model="#Object" animation="property: rotation; to: 0 40 0; dur: 1300; easing: easeOutCubic;" drag-rotate-component zoom > </a-entity>
    <a-camera id="player" position="0 6 17" zvalue="-3" look-controls="enabled:true" wasd-controls="enabled:true">
	</a-camera>
	
<a-light type="ambient" color="#fff" intensity="0.6" castShadow="true"></a-light>

<a-light type="ambient" color="#888" intensity="1.5" castShadow="true"></a-light>

  </a-scene>
  
</body>




</html>
